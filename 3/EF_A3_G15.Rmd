---
title: "EF Group Submission Assignment 3"
subtitle: "Group 15" 
author: "Lanlan Hou (2801069), Rick van der Ploeg (2782774), Sebastiaan van Dijen (2769505) and Alfred Sou (2796840)"
output: pdf_document
---

# Question 1

## a.
```{r echo=TRUE,fig.dim=c(5,4),fig.align='center'}
library(openxlsx)
raw <- read.xlsx('student_groups_stocks.xlsx', sheet = 1)

groupNumber <- 15
nameOfStock <- raw$Stock.Name[groupNumber]
startDate <- raw$Start.Date[groupNumber]
endDate <- raw$`End.Date.(+10y)`[groupNumber]

# Compute the start date of the final five years
library(lubridate)

originalDate <- as.Date(startDate)
endDate_firstFiveYears <- originalDate %m+% years(5)

# Extract the daily stock price from source
library(quantmod)

getSymbols(nameOfStock, src = 'yahoo', from = startDate, to = endDate_firstFiveYears)
date <- index(HSBC)

# Adjusted Close
adjustedPrice <- as.numeric(HSBC[,'HSBC.Adjusted'])

# Log Returns
compoundedReturns <- numeric(length(adjustedPrice) - 1)
for(i in (2:length(adjustedPrice))){
  compoundedReturns[i-1] <- log(adjustedPrice[i] / adjustedPrice[i-1])
}

library(rugarch)

# Specify AR(1)-GARCH(1,1) model uwith normally distributed errors
ar1garch11_spec_norm <- ugarchspec(variance.model = list(model = 'sGARCH',
                                                    garchOrder = c(1, 1)),
                              mean.model = list(armaOrder = c(1, 0),
                        include.mean = TRUE),
                        distribution.model = 'norm')

ar1garch11_fit_norm <- ugarchfit(spec = ar1garch11_spec_norm, data = compoundedReturns)

ar1garch11_fit_norm@fit$matcoef
```

## b.
```{r echo=TRUE,fig.dim=c(5,4),fig.align='center'}

```

# Question 2

## a.
```{r echo=TRUE, fig.dim=c(5,4),fig.align='center'}
ar1garch11_spec_t <- ugarchspec(variance.model = list(model = 'sGARCH',
                                                    garchOrder = c(1, 1)),
                              mean.model = list(armaOrder = c(1, 0),
                        include.mean = TRUE),
                        distribution.model = 'std')

ar1garch11_fit_t <- ugarchfit(spec = ar1garch11_spec_t, data = compoundedReturns)

ar1garch11_fit_t@fit$matcoef
```

## b.
```{r echo=TRUE, fig.dim=c(5,4), fig.align='center'}

```